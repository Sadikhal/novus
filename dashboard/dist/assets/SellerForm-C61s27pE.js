import{r as o,u as M,a as R,b as U,j as e,I as i,B as N,c as $,o as L,d as Q,n as T,s as l}from"./index-BeksSBPr.js";const V=L({name:l().min(3,{message:"Name must be at least 3 characters"}).max(10,{message:"Name must be at most 10 characters"}),address1:l().min(8,{message:"Address must be at least 8 characters"}),address2:l().optional(),city:l().min(1,{message:"City is required"}),state:l().min(1,{message:"State is required"}),pincode:l().length(6,{message:"Pincode must be 6 digits"}).regex(/^\d+$/,{message:"Pincode must contain only numbers"}),number:l().min(10,{message:"Phone number must be 10 digits"}).max(10,{message:"Phone number must be 10 digits"}).regex(/^\d+$/,{message:"Phone number must contain only numbers"}),experience:T().optional(),image:Q(l()).min(1,"At least one image is required")}),_=({data:t,type:c,setOpen:b,onSuccess:S})=>{const[u,h]=o.useState(!1),{toast:p}=M(),[C,d]=o.useState([]),[w,f]=o.useState(!1),[m,g]=o.useState(t?.image||[]),y=o.useRef(null),P={name:"",address1:"",address2:"",city:"",state:"",pincode:"",number:"",experience:0,image:[],...t||{}},{register:n,handleSubmit:I,reset:j,formState:{errors:r},setValue:v,watch:Y}=R({resolver:U(V),defaultValues:P});o.useEffect(()=>{t&&(j({...t,pincode:t.pincode?.toString(),number:t.number?.toString(),experience:t.experience?Number(t.experience):0,image:t.image||[]}),g(t.image||[]))},[t,j]);const B=a=>{const s=Array.from(a.target.files),x=5-m.length;if(s.length>x){p({variant:"destructive",title:"Too many images",description:`You can only upload ${x} more images.`});return}d(s),f(!0)},k=a=>{g(s=>[...s,a]),v("image",[...m,a]),d(s=>s.slice(1))},A=()=>{d(a=>a.slice(1))},E=a=>{const s=m.filter((x,q)=>q!==a);g(s),v("image",s)},F=async a=>{h(!0);try{await S(a),p({variant:"success",title:c==="create"?"Brand created":"Brand updated",description:c==="create"?"New brand added successfully":"Your changes have been saved"}),b(!1)}catch(s){p({variant:"destructive",title:"Operation failed",description:s.message||"Please try again later"})}finally{h(!1)}};return e.jsxs("form",{className:"flex flex-col gap-6 p-2 sm:p-4 h-full",onSubmit:I(F),children:[e.jsxs("h1",{className:"text-xl font-semibold border-b-[#384e60] border-b-2 pb-2 ",children:[c==="create"?"Create New":"Edit"," Brand"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(i,{label:"Brand Name",name:"name",type:"text",register:n,error:r.name}),e.jsx(i,{label:"Phone Number",name:"number",type:"tel",register:n,error:r.number,inputProps:{maxLength:10,pattern:"[0-9]*"}}),e.jsx(i,{label:"Primary Address",name:"address1",type:"text",register:n,error:r.address1,className:"md:col-span-2"}),e.jsx(i,{label:"Secondary Address",name:"address2",type:"text",register:n,error:r.address2,className:"md:col-span-2"}),e.jsx(i,{label:"City",name:"city",type:"text",register:n,error:r.city}),e.jsx(i,{label:"State",name:"state",type:"text",register:n,error:r.state}),e.jsx(i,{label:"Pincode",name:"pincode",type:"text",register:n,error:r.pincode,inputProps:{maxLength:6,pattern:"[0-9]*"}}),e.jsx(i,{label:"Experience (years)",name:"experience",type:"number",register:n,error:r.experience}),e.jsxs("div",{className:"md:col-span-2 flex flex-col gap-4 h-full",children:[e.jsx("label",{className:"text-sm font-medium",children:"Brand Images (Max 5)"}),e.jsx("input",{type:"file",ref:y,multiple:!0,accept:"image/*",onChange:B,className:"hidden"}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[m.map((a,s)=>e.jsxs("div",{className:"relative group border border-slate-300 p-2 rounded-lg",children:[e.jsx("img",{src:a,alt:`Brand preview ${s+1}`,className:"w-32 h-32 object-cover rounded-md border border-gray-300"}),e.jsx("button",{type:"button",onClick:()=>E(s),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:"Ã—"})]},a)),m.length<5&&e.jsx("div",{className:"flex gap-6",children:e.jsx("label",{onClick:()=>y.current.click(),htmlFor:"fileInput",className:"cursor-pointer flex items-center justify-center rounded-md bg-white hover:bg-gray-100 relative w-36 h-36 border-2 border-dashed text-gray-500 hover:border-teal-500 hover:text-teal-500 transition-colors",children:e.jsx("img",{src:"/images/model.png",className:"w-9 absolute h-9 object-cover",alt:""})})})]}),r.image?.message&&e.jsx("p",{className:"text-xs text-red-400",children:r.image.message.toString()})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsx(N,{type:"button",variant:"secondary",onClick:()=>b(!1),disabled:u,children:"Cancel"}),e.jsx(N,{type:"submit",variant:"primary",disabled:u,children:u?"Processing...":c==="create"?"Create Brand":"Save Changes"})]}),e.jsx($,{isOpen:w,onClose:()=>{f(!1),d([])},onUploadComplete:k,onSkipCurrent:A,queue:C})]})};export{_ as default};
