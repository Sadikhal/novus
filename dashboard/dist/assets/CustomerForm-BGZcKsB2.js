import{r as s,u as E,a as M,b as k,j as e,I as n,B as x,c as D,o as R,s as o,e as G}from"./index-BeksSBPr.js";const T=R({name:o().min(3,{message:"Username must be at least 3 characters long!"}).max(8,{message:"Username must be at most 8 characters long!"}),email:o().email({message:"Invalid email address!"}),number:o().min(10,{message:"Phone number must be 10 digits"}).max(10,{message:"Phone number must be 10 digits"}).regex(/^\d+$/,{message:"Phone number must contain only numbers"}).optional(),dateOfBirth:G().optional(),image:o().optional()}),J=({data:a,type:V="update",setOpen:f,onSuccess:I})=>{const[m,h]=s.useState(!1),[b,q]=s.useState(!1),[C,c]=s.useState(!1),[j,d]=s.useState(null),[u,g]=s.useState(a?.image||""),y=s.useRef(null),{toast:p}=E(),S={name:"",email:"",number:"",dateOfBirth:"",image:"",...a||{}},{register:i,handleSubmit:B,reset:v,setValue:N,formState:{errors:r}}=M({resolver:k(T),defaultValues:S});s.useEffect(()=>{a&&(v({...a,dateOfBirth:a.dateOfBirth?P(a.dateOfBirth):"",image:a.image||""}),g(a.image||""))},[a,v]);const P=t=>new Date(t).toISOString().split("T")[0],F=t=>{const l=t.target.files[0];if(l){if(!l.type.match("image.*")){p({variant:"destructive",title:"Invalid file type",description:"Please select an image file"});return}d(l),c(!0)}},O=async t=>{g(t),N("image",t),c(!1),d(null)},w=()=>{g(""),N("image","")},U=async t=>{h(!0);try{await I(t),p({variant:"success",title:"Customer updated",description:"Your changes have been saved"}),f(!1)}catch(l){p({variant:"destructive",title:"Operation failed",description:l.message||"Please try again later"})}finally{h(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{className:"flex flex-col gap-6 p-2 sm:p-4",onSubmit:B(U),children:[e.jsx("h1",{className:"text-xl font-semibold border-b-[#384e60] border-b-2 pb-2",children:"Edit Customer Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(n,{label:"Full Name",name:"name",type:"text",register:i,error:r.name}),e.jsx(n,{label:"Email Address",name:"email",type:"email",register:i,error:r.email}),e.jsx(n,{label:"Phone Number",name:"number",type:"tel",register:i,error:r.number,inputProps:{maxLength:10,pattern:"[0-9]*"}}),e.jsx(n,{label:"Date of Birth",name:"dateOfBirth",type:"date",register:i,error:r.dateOfBirth}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Profile Image"}),e.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[u?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:u,alt:"Customer profile",className:"w-24 h-24 rounded-full object-cover border-2 border-gray-200"}),e.jsx("button",{type:"button",onClick:w,className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:"Ã—"})]}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400 text-xs",children:"No image"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("input",{type:"file",ref:y,accept:"image/*",onChange:F,className:"hidden"}),e.jsx(x,{type:"button",variant:"outline",className:"border-slate-400 cursor-pointer",onClick:()=>y.current.click(),disabled:b,children:u?"Change Image":"Upload Image"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPG, PNG (Max 5MB)"})]})]}),r.image?.message&&e.jsx("p",{className:"text-xs text-red-800 mt-1",children:r.image.message.toString()})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsx(x,{type:"button",variant:"secondary",onClick:()=>f(!1),disabled:m,children:"Cancel"}),e.jsx(x,{type:"submit",variant:"primary",disabled:m||b,children:m?"Processing...":"Save Changes"})]})]}),e.jsx(D,{isOpen:C,onClose:()=>{c(!1),d(null)},onUploadComplete:O,queue:j?[j]:[]})]})};export{J as default};
